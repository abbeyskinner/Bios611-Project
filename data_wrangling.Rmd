---
title: "Data Wrangling"
output: pdf_document
date: "2024-09-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
contestant_data <- read_csv("/home/rstudio/work/data/survivor/contestant_table.csv")
season_data <- read_csv("/home/rstudio/work/data/survivor/season_table.csv")
tribe_data <- read_csv("/home/rstudio/work/data/survivor/tribe_table.csv")
```

I think I'll def use contestant_data and maybe season_data too but not sure about tribe_data

```{r}
## probably should look at proportions for most of these 
ggplot(contestant_data, aes(x=age)) +
  geom_histogram()

ggplot(contestant_data, aes(x=gender)) +
  geom_bar()

ggplot(contestant_data, aes(x=poc)) +
  geom_bar()


contestant_data %>%
  group_by(profession) %>%
  tally()%>% arrange(desc(n))

contestant_data %>%
  group_by(state) %>%
  tally()%>% arrange(desc(n))
```
I think the profession needs to be tidied:
Okay what can i combine?
- Teacher: 4th Grade Teacher, Art Teacher, Elementary Teacher, English Teacher, Gym Teacher, high school teacher
- Professor: English Professor, English professor
- Actor: Actor, Actress, Aspiring Actress, former tv teen star
- Veteran: Air Force Veteran, Army Veteran, Iraq War Veteran, marine
- Student: Art Student, Business Student, College Student, Cosmetology Student, Crossfit Coach/Physical Therapy Student. Dental Student, Economics Student, full-time student/sales, grad student, graduate student, harvard law student, high school student, Ivy League Student, law school student, law student, law studnet/former military, mba student, medical student
- Career Consultant + Career Counselor
- Coach: Baseball/Dating Coach, Basketball Coach, Cheerleading Coach, Crossfit Trainer, Crossfit Coach/Project Coordinator, fitness instructor, former nfl coach, gymnastics coach, hiking guide, life coach/speaker/yoga teacher, navy swim instructro
- Gym Owner: Competitive Cheerleading Gym Owner, gym owner
- Attorney: Attorney + Civil Rights Attorney + Defense Attorney, Deputy District Attorney, Divorce Attorney, Attorney/Former NFL Player + Attorney/Retired NFL Player
- Barista: Barista + Coffee Barista
- Computer Programmer: Computer Programmer + Computer Engineer
- Construction: Construction Company Vice President, Construction Supervisor, Construction Worker, highway construction
- Designer + Aspiring Designer
- Doctor: Doctor, ER Doctor
- Entertainment Host + Writer: Entertainment Host and Writer, Entertainment Host/Writer
- Firefighter: Firefighter, Fireman/EMT
- Fisher: fisherwoman, fishing boat captain, fishing guide, fishmonnger
- Pro Athlete: former nba all-star, former nba player, former mlb player, former mfl quarterback, former nhl player,former professional cyclist, former pro cyclist/shop manager, mixed martial arts fighter, nfl player
- writer: aspiring writer, freelance writer
- farmer: goat farmer, farmer, goat racher
- sales: elevator salesman, graphic saleswoman, insurance saleswoman
- Hairdresser: hairdresser, hairsytlist
- Singer: country music signer, former pop star, heavy metal musican
- Animal Trainer: horse trainer, dolphin trainer, dog trainer
- Internet Project Manager: Internet Projects Manager, Internet Project Manager
- Jewelry: Jeweler, Jewelry Designer, Jewelry Salesman/Photographer
- lifeguard: lifeguard + former lifeguard


** i stiopped on page 32 -- idk if i want to keep doing this
** note:  Cheif Lifegaurd, industrial engineer

```{r}

## winners
contestant_data %>%
  filter(finish==1) %>%
  ggplot(aes(x=age))+
  geom_histogram()

contestant_data %>%
  filter(finish==1) %>%
  ggplot(aes(gender)) +
 geom_bar(aes(fill = as.factor(poc)), position = "dodge")

contestant_data %>%
  filter(finish==1) %>%
  ggplot(aes(poc)) +
  geom_bar()

contestant_data %>%
  filter(finish==1) %>% 
  group_by(profession) %>% tally() %>% arrange(desc(n))

contestant_data %>%
  filter(ftc==1)

```

```{r}
## first voted out
contestant_data %>%
  filter(
    finish==16 & num_season %in% c(1,2,3,4,5,6,7,12,15,18) |
    finish==18 & num_season %in% c(8,9,11,17,22,23,24,25,28,29,30,32,35,38,41,42,43) |
    finish==19 & num_season ==14 |
    finish==20
  )  %>%
  ggplot(aes(x=age)) +
  geom_histogram(aes(fill = as.factor(gender)), position = "dodge")

contestant_data %>%
  filter(
    finish==16 & num_season %in% c(1,2,3,4,5,6,7,12,15,18) |
    finish==18 & num_season %in% c(8,9,11,17,22,23,24,25,28,29,30,32,35,38,41,42,43) |
    finish==19 & num_season ==14 |
    finish==20
  )  %>%
  ggplot(aes(gender)) +
 geom_bar(aes(fill = as.factor(poc)), position = "dodge")

contestant_data %>%
  filter(
    finish==16 & num_season %in% c(1,2,3,4,5,6,7,12,15,18) |
    finish==18 & num_season %in% c(8,9,11,17,22,23,24,25,28,29,30,32,35,38,41,42,43) |
    finish==19 & num_season ==14 |
    finish==20
  )  %>%
  ggplot(aes(poc)) +
  geom_bar()
```

```{r}
# made the merge
contestant_data %>%
  filter(merge==1) %>%
  ggplot(aes(age)) +
  geom_histogram()

contestant_data %>%
  filter(merge==1) %>%
  ggplot(aes(gender)) +
  geom_bar()

contestant_data %>%
  filter(merge==1)%>%
  group_by(profession) %>% tally() %>% arrange(desc(n))
```

What are some things I could look at?

What types of people win? What types of people make final tribal (+ dont win?) What types of people get voted out first? What types of people don't make the merge v do make the merge? Is there a "lucky" buff color -- i.e. the first color buff that a contest is assigned to - compare this with winners 1st buff colors.


** okay wait... apparently there is an R package called `survivoR` that has data on different things of each season!!!! Im gunna go through them now:

```{r}
advantage_details
advantage_data <- advantage_movement
castaways
castaway_details
challenge_description
challenge_results
challenge_summary
confessionals %>% arrange(desc(confessional_count))
episodes %>% arrange(desc(viewers))
screen_time
season_summary
vote_history

confessional_data <- confessionals
```

```{r}
challenge_data <- challenge_results %>%
 filter(version =="US",
        season <= 43) 

challenge_wins <- challenge_data %>%
  mutate(
    result = case_when(
    result == "Won" ~ 1,
    result == "Lost" ~ 0,
    result == "Won (immunity only)" ~ 1,
    result == "Won (reward only)" ~ 1,
    result == "Draw" ~ 0 ## treating ties as losses
  )) %>% 
  group_by(castaway_id, season) %>%
  summarise(
    total_challenges_competed = n(),
    total_won = sum(result),
    total_sit_outs = sum(sit_out)
  ) %>%
  mutate(
    win_percentage = total_won/(total_challenges_competed - total_sit_outs)
  ) %>%
  arrange(season)

contestant_data <- contestant_data %>%
  mutate(
    win_percentange = challenge_wins$win_percentage,
    castaway_id = challenge_wins$castaway_id
  )
```


Okay... plan of action -- this is too much data and its overwhelming so I'm gunna stick with what I have except I want to add win percentage. So i can calculate the win percentages and then filter that data so that it matches with the data I have (bc i only have until season 43 i think -- or I can add the contestants that I'm missing bc I do have all their info). Then i can merge it into my contestant dataset so I can see how win percentage plays a part in your overall play. If im feeling up to it i could also go through the advantage data and make a boolean for if a contestant found an advantage (and if they used it -- used it correctly -- and number of advantages found)

```{r}
advantage_data <- advantage_movement %>%
  filter(version == "US",
        season <= 43)

## found advantage -- add number of advantages and boolean
advantages <- advantage_data %>%
  filter(event %in% c("Found", "Found (beware)", "Received", "Recieved")) %>%
  mutate(num_season=season) %>%
  group_by(castaway_id, num_season) %>%
  summarise(
    num_advantages = n()
  ) %>% arrange(num_season)

contestant_data2 <- contestant_data %>%
  left_join(advantages , by = c("castaway_id", "num_season")) %>%
  mutate(num_advantages = replace_na(num_advantages, 0),
         advantage = case_when( # boolean for advantage
           num_advantages > 0 ~ 1,
           num_advantages == 0 ~ 0
         ))

## played advantaged successfully
advantages_success <- advantage_data %>%
  filter(event == "Played", success == "Yes") %>%
  mutate(num_season=season) %>%
  group_by(castaway_id, num_season) %>%
  summarise(
    num_success=n()
  )

contestant_data3 <- contestant_data2 %>%
  left_join(advantages_success, by = c("castaway_id", "num_season")) %>%
  mutate(num_success = replace_na(num_success, 0),
         advantage_success_rate = num_success/num_advantages, # success rate
         success = case_when( # boolean for successfully playing advantage
           num_success > 0 ~ 1,
           num_success == 0 ~ 0
         ))
```

```{r}
## Professions

# Create a function to categorize professions
categorize_profession <- function(profession) {
  # Use a case_when to assign each profession to a category
  category <- dplyr::case_when(
    profession %in% c("Doctor", "Nurse", "Physician", "Nurse Practitioner", "Medical Student", "Phlebotomist",
                      "Pharmacist", "Clinical Psychologist", "Pediatric Nurse", "Anesthesiologist", "Plastic Surgeon",
                      "Urologist", "ER Doctor", "Surgeon", "Nursing Student", "Medical Assistant", 
                       "Dental Student", "Pharmacy Technician", "Neurologist", "Personal Nurse", 
                      "Dentist", "Mortician", "Nursing Practitioner", "Retired Nurse", "EMT/Pro Cheerleader",
                      "Physician/Army Orthopedic Surgery Resident", "Physical Therapist", "Neurosurgeon",
                      "Healthcare Worker", "Therapist", "Heart Valve Specialist") 
    ~ "Healthcare & Medical",
    
    profession %in% c("Biochemist", "Equity Research Assistant", "Chemical Disposal", "Chemist")
    ~ "Science & Research",
    
    profession %in% c("Pharmaceutical Saleswoman", "Pharmaceutical Sales Representative", "Pharmaceutical Sales",
                        "Medical Saleswoman", "Medical Marijuana Dispenser", "Healthcare Consultant", 
                        "Medical Sales Representative", "Pharmaceutical Representative") 
    ~ "Healthcare Sales",
    
    profession %in% c("Real Estate Developer", "Real Estate Agent", "Real Estate Salesman", "Real State Agent",
                        "Real Estate Broker", "Real Estate Manager", "Property Developer", "Real Estate",
                        "Land Broker", "Residential Builder", "Real Estate Executive", "Realtor", 
                      "Real Estate Agent/Stay-at-home Dad") 
    ~ "Real Estate",
    
    profession %in% c("College Student", "Graduate Student", "PhD Student", "High School Student", "Student/Athlete",
                      "Economics Student", "Student", "Ivy League Student", "Seminary Student", "Business Student",
                      "Political Science PhD", "Ivy League Graduate", "Pre-Med Student", "Model/Student", 
                      "Full-Time Student/Sales", "Crossfit Coach/Physical Therapy Student", "Grad Student") 
    ~ "Student",
    
    profession %in% c("Teacher", "Professor", "Principal", "College Administrator", "Admissions Counselor", 
                      "Academic Intern", "High School Teacher", "Elementary Teacher", "English Teacher", 
                      "P.E. Teacher", "Yoga Instructor/Math Professor", "School Principal", "Gym Teacher", 
                      "English Professor", "Art Teacher", "Student Teacher", "College Admissions Director", 
                        "Education Project Manager", "School Lunch Lady", "4th Grade Teacher", "Bookkeeper",
                      "Physical Education Teacher", "Retired Teacher", "Guidance Counselor", "Physics Teacher",
                      "English Profressor", "Special Education Teacher", "English professor", "Music Teacher") 
    ~ "Education & Academia",
    
    profession %in% c("Sales Manager", "Marketing Director", "Advertising Executive", "Retail Salesperson", 
                       "Internet Projects Manager", "Sales Executive", "Marketing Executive", "Freelance Marketer",
                      "Digital Content Creator", "Account Manager", "Sales & Marketing Associate",
                      "Marketing Manager", "Advertising Salesman", "Sales Representative", "Elevator Salesman",
                        "Communications Manager", "Management Consultant", "Marketing Manager", "Used Car Salesman",
                      "Retail Saleswoman", "Financial Salesman", "Shoe Salesman", "Copier Sales Executive", 
                      "Spa Saleswoman", "Saleswoman", "Insurance Saleswoman", "BMX Bike Salesman", "Software Sales",
                      "Traveling Sales Representative", "Social Media Marketer", "Vacation Club Saleswoman", 
                      "Vacation Club Sales", "Graphic Saleswoman", "Social Media Strategist", "Tech Sales",
                      "Advertising Account Executive", "Publishing CEO", "District Sales Manager", 
                      "Director of Marketing & Communications", "Cyber Security Saleswoman", 
                      "Jewelry Salesman/Photographer", "Social Media Manager") 
    ~ "Sales & Marketing",
    
    profession %in% c("Actor", "Actress", "Musician", "Singer", "Artist", "Writer", "Comedian", "Broadcaster", 
                      "Media Consultant", "Photographer", "Television Writer", "Creative Director", 
                      "Musician/Retired Teacher", "Singer/Songwriter", "Aspiring Actress", "Art Consultant",
                      "Freelance Writer", "Vegas Showgirl", "Singer/Entertainer", "Fire Dancer", "Jazz Musician",
                      "Heavy Metal Musician", "Former Model", "Aspiring Writer", "Music Producer", "Wedding Videographer",
                      "Former Pop Star", "Art Student", "Visual Effects Producer", "Spoken Word Artist",
                      "Country Music Singer", "Stand-Up Comedian", "Former TV Teen Star", "Entertainment Host and Writer",
                      "Comic Book Artist", "Singer/Actor/Writer", "Broadway Performer/Model/Aerialist",
                      "Ex-Talent Agent Assistant", "YouTube Sensation", "Entertainment Host/Writer", "Filmmaker", 
                      "Multimedia Artist", "Morning News Anchor", "Talent Manager", "Christian Radio Host", 
                      "Host/Keynote Speaker")
    ~ "Arts, Entertainment & Media",
          
    profession %in% c("Model", "Swimsuit Model", "Pin-Up Model", "Fashion Director", "Footwear Designer",
                        "Cosmetology Student", "Jewelry Designer", "Fashion Stylist", "Massage Therapist",
                        "Makeup Artist", "Hairstylist", "Nail Salon Manager", "Hairdresser","Pageant Coach",
                      "Aspiring Designer", "T-shirt Designer", "Swimsuit Photographer", "Cosmetologist", "Designer",
                      "Former Miss Delaware", "Male Model", "Miss Kentucky Teen USA", "Furniture Designer",
                      "Interior Designer") 
    ~ "Fashion & Beauty",
    
    profession %in% c("Business Consultant", "Executive Recruiter", "Corporate Trainer", "Product Manager", 
                       "Financial Consultant","Business Development Manager","CEO", "MBA Student", "Financial Assistant",
                      "Investment Banker", "Actuary", "Tax Accountant", "Loan Officer", "Health Club Consultant",
                  "Administrative Assistant", "Behavior Analyst", "Office Manager", "Construction Company Vice President", 
                      "Office Assistant", "Equity Trade Manager", "Document Manager", "Risk Consultant", 
                  "Corporate Consultant", "Office Manager", "Banker", "Administrative Officer", "Accountant", 
                  "Corporate Executive", "Asset Manager", "Insurance Adjuster", "Business Analyst", "Case Manager",
                  "Product Management", "Educational Project Manager", "Project Manager") 
    ~ "Finance/Business Services",

    profession %in% c("Lawyer", "District Attorney", "Defense Attorney", "Attorney", "Paralegal", "Judge", 
                    "Trial Attorney", "Civil Rights Attorney", "Legal Secretary", "Public Defender", 
                   "Probation Officer", "Corporate Lawyer", "Law Student", "Law School Student", "Pre-Law Student", 
                   "Law Clerk", "Crime Reporter", "Deputy District Attorney", "Expert Witness Locator", 
                   "Harvard Law Student", "Attorney/Retired NFL Player", "Assistant District Attorney", 
                   "Law Student/Former Military", "Divorce Attorney", "Personal Injury Attorney", 
                   "Attorney/Former NFL Player") 
    ~ "Legal",
    
    profession %in% c("Electrician", "Plumber", "Carpenter", "Mechanic", "Technical Writer", 
                      "Welder", "HVAC Technician", "Construction Worker", "Telephone Technician", "Truck Assembler",
                      "Highway Repair Worker", "Highway Construction Worker", "Steelworker", "Maintenance Man",
                      "Oil Tanker Crewman", "Motorcycle Repairwoman", "Tire Repairman", "General Contractor", 
                      "Oil Driller", "Contractor", "Boat Mechanic", "Construction Supervisor", "Maintenance Manager", 
                      "Factory Worker", "Warehouse Associate", "Auto Customizer", "Lumberjill", 
                      "Water Treatment Technician") 
    ~ "Skilled Trades & Technical",
    
    profession %in% c("Police Officer", "FBI Agent", "Security Officer", "Retired Navy Seal", "Army Veteran", 
                      "Sheriff", "Corrections Officer", "Navy Seal", "Marine", "SWAT Officer", "Firefighter", 
                      "Detective", "Retired NAVY Seal", "Army Intelligence Officer", "Retired Police Officer",
                      "Ex-Navy Fighter Pilot", "Drill Sergeant", "Retired Fire Captain", "Police Sergeant",
                      "U.S. Army Sergeant", "Iraq War Veteran", "Former Federal Agent?", "Retired NYPD Detective",
                      "Retired LAPD Officer", "Fireman/EMT", "State Trooper", "Former FBI Agent", "S.W.A.T. Officer", 
                      "Air Force Veteran", "Retired Firefighter") 
    ~ "Law Enforcement & Military",
    
    profession %in% c("Personal Trainer", "Fitness Instructor", "CrossFit Coach", "Triathlon Coach", 
                      "Professional Athlete", "NFL/NHL Player", "Gym Owner", "Sports Coach", "Yoga Instructor", 
                       "YMCA Basketball Coach", "Ex-NFL Player", "Former Pro Cyclist", "Olympian", "Paralympian",
                      "Competitive Cyclist", "Professional Soccer Player", "Former Professional Athlete", 
                        "Yoga Instructor", "Basketball Coach", "Navy Swim Instructor", "Health and Fitness Reporter",
                      "Water Skiing Instructor", "Former NFL Quarterback", "Sports Radio Host", "Professional Wrestler",
                      "Profession Volleyball Player", "Boxer", "Cheerleading Coach", "Surfing Instructor",
                      "Gymnastics Coach", "Olympic Gold Medalist", "Professional Cyclist", "Soccer Coach/Musician",
                      "Former Professional Cyclist", "Former NFL Coach", "Swim Coach", "Professional Dancer", 
                      "Dance Team Manager", "Lingerie Football Player", "Baseball/Dating Coach", "Former MLB Player", 
                      "Track Coach", "Former Pro Cyclist/Shop Manager", "Former NBA All-Star", "Ex-NFL Cheerleader",
                      "Pilates Teacher", "Martial Arts Instructor", "Crossfit Coach/Project Coordinator", 
                      "Sailing Instructor", "Former NBA Player", "Bodybuilder", "Dietitian", "Snowboard Instructor",
                      "NFL Player", "Lifeguard", "Mixed Martial Arts Fighter", "Former NHL Player", "Olympic Medalist",
                      "Chief Lifeguard", "CrossFit Trainer", "Fitness Consultant", "Roller Girl", "Surf Instructor") 
    ~ "Sports & Fitness",
    
   profession %in% c("Social Worker", "Youth Pastor", "Youth Mentor", "Mentor", "Life Coach", "Volunteer",
                     "Mail Carrier", "Career Counselor", "Pastor", "Troubled Teens Mentor", "Motivational Speaker",
                     "Housing Case Manager", "Non-Profit Fundraiser", "Charity Organizer", "Professional Speaker",
                     "Postal Worker", "Homeless Shelter Manager", "YMCA Program Director", "Career Consultant",
                     "Keynote Speaker/Social Entrepreneur", "Life Coach/Speaker/Yoga Teacher")
                      
   ~ "Community & Social Services",
    
    profession %in% c("Chef", "Bartender", "Waiter", "Restaurant Owner", "Hotel Doorman", "Caterer", 
                      "Food Service Worker", "Sushi Chef", "Fast Food Franchisee", "Cocktail Waitress",
                      "Cook", "Food Truck Operator", "Restaurant Manager", "Barista", "Waitress", "Coffee Barista", 
                      "Waitress/Bartender", "Personal Chef", "Flight Attendant", "Restaurant Designer", 
                      "Cocktail Waitress/Graphic Designer", "Bellhop", "Kitchen Staff Member", "Bar Manager",
                      "Club Promoter") 
   ~ "Food & Hospitality",
    
    profession %in% c("Farmer", "Rancher", "Fisherman", "Gardener", "Beekeeper", "Wilderness Guide", 
                      "Hunting Guide", "Conservationist", "Park Ranger", "Commercial Fisherman", "Dairy Farmer",
                      "River Rafting Guide", "Teacher/Farmer", "Goat Farmer", "Nature Guide", "Fishing Boat Captain",
                      "Children's Adventure Guide", "Scoutmaster", "Sheep Farmer", "Chicken Farmer", "Hiking Guide",
                      "Cattle Rancher", "Goat Rancher", "Post Office Manager/Farmer", "River Guide", 
                      "Wilderness Therapy Guide", "Fisherwoman", "Fishing Guide", "Fishmonnger") 
                      
   ~ "Agriculture & Outdoors",
    
    profession %in% c("Software Developer", "Engineer", "Technology Executive", "IT Manager", "Cybersecurity Analyst", 
                      "App Developer", "Internet Projects Manager", "UX Designer", "Robotics Scientist",
                      "Data Scientist", "Cyber Security Analyst", "Software Publisher", "Rocket Scientist",
                      "Computer Projects Coordinator", "Computer Programmer", "Missile Engineer", "Web Producer",
                      "Internet Technology Director", "Computer Engineer", "Engineer Graduate/Model", "Nuclear Engineer",
                      "Yahoo! Executive", "Quantitative Strategist", "Internet Project Manager", "Industrial Engineer") 
   ~ "Technology & Engineering",
   
    profession %in% c("Business Owner", "Entrepreneur", "Small Business Owner", "Franchise Owner", 
                      "Bowling Alley Owner", "Oil Company Owner", "Pest Control Company Owner", 
                      "Paddleboard Company Owner", "Bridal Shop Owner", "Cigar Lounge Owner", 
                      "Model/Spray Tan Business Owner", "Competitive Cheerleading Gym Owner", "Furniture Company Owner",
                      "Sideline Chic Owner", "Beach Service Company Owner")
   ~ "Business Owner",
   
   profession %in% c("Homemaker", "Nanny", "Single Mother", "Caretaker", "Stay-at-Home Mom",
                     "Stay-at-Home Dad") ~ "Caretaker",
   profession %in% c("Dolphin Trainer", "Zookeeper", "Dog Trainer","Horse Trainer", "Marine Animal Trainer",
                     "Veterinarian", "Pet Cremator") 
   ~ "Animal Care",

    
    # If it doesn’t fit into any category above, categorize as "Other"
    TRUE ~ "Other"
  )
  
  return(category)
}

contestant_data3 <- contestant_data3 %>%
  mutate(job_category = profession)

# Apply the categorization function to the 'profession' column
contestant_data3$job_category <- sapply(contestant_data3$job_category, categorize_profession)
```

```{r}

```




headshots -- using their faces to predict how long they last in the season -- can attractiveness predict how long you stay in the game

